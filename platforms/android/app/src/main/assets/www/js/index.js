//var _0x1598=['Sunday','FEB','MAR','MAY','JUN','JUL','AUG','OCT','NOV','DEC','backbutton','notification','confirm','Exit\x20application?','app','exitApp','Cancel','Exit','plugins','local','cancelAll','sys','getItem','remember','true','#rememberme','prop','checked','onLogin','.alert','hide','#currentVersion','html','empnumber','mypass','#empnumber','val','#password','validation','ajax','service/login','json','password','show','readonly','attr','#loginButton','disabled','#loadingDiv','removeAttr','validated','college_1','college_2','full_name','full_empnumber','employment_date',':checked','notification-','notifications\x20cancelled\x20:\x20BEFORE\x20RE\x20SCHEDULED','toggleSwitch','initial','location','initialsetup.html','profile.html','Invalid\x20Login','ERROR\x20AT\x20AJAX\x20LOGIN\x20:\x20','stringify','There\x20was\x20an\x20error\x20connecting\x20to\x20the\x20server.','Employee\x20number\x20and\x20password\x20is\x20required.','length','which','keyCode','replace','index.html','Daily\x20Time\x20Record\x20Alert','each','amS','split','day','amE','pmS','PM\x20TIME\x20IN','PM\x20TIME\x20OUT','pmE','schedule','trigger','data','processor','service/serverdt','setRequestHeader','date','#curdate-holder','attendance/dtr','POST','pdate','type','OUT','DTR\x20Alert:\x20Time\x20out\x20for\x20am\x20schedule','DTR\x20Alert:\x2010\x20Minutes\x20before\x20PM\x20time\x20in','DTR\x20Alert:\x20Time\x20out\x20for\x20pm\x20schedule','DTR\x20Reminder','setItem','ecode','u9n4mT^a|X!545P','isEmu','false','showAlert','console','isBypass','isRemember','version','3.1.3','server','https://supportstaff.ust.edu.ph/restServiceUSSAP/resources/','6:00\x20am','6:30\x20am','7:00\x20am','7:30\x20am','8:30\x20am','9:00\x20am','10:00\x20am','11:00\x20am','11:30\x20am','12:00\x20pm','1:00\x20pm','1:30\x20pm','2:00\x20pm','2:30\x20pm','3:00\x20pm','3:30\x20pm','4:00\x20pm','4:30\x20pm','5:30\x20pm','6:30\x20pm','7:30\x20pm','8:00\x20pm','8:30\x20pm','9:00\x20pm','9:30\x20pm','10:00\x20pm','10:30\x20pm','Thursday','Friday','Satruday'];(function(_0xbc0dd2,_0x11a66b){var _0x311bfa=function(_0x54b866){while(--_0x54b866){_0xbc0dd2['push'](_0xbc0dd2['shift']());}};_0x311bfa(++_0x11a66b);}(_0x1598,0x65));var _0x8966=function(_0x46f2f5,_0x17b113){_0x46f2f5=_0x46f2f5-0x0;var _0x1f1cd7=_0x1598[_0x46f2f5];return _0x1f1cd7;};localStorage[_0x8966('0x0')](_0x8966('0x1'),_0x8966('0x2'));localStorage['setItem'](_0x8966('0x3'),_0x8966('0x4'));localStorage[_0x8966('0x0')](_0x8966('0x5'),_0x8966('0x6'));localStorage[_0x8966('0x0')](_0x8966('0x7'),_0x8966('0x4'));localStorage[_0x8966('0x0')](_0x8966('0x8'),_0x8966('0x4'));localStorage[_0x8966('0x0')]('curinfo','0');localStorage['setItem'](_0x8966('0x9'),_0x8966('0xa'));localStorage[_0x8966('0x0')](_0x8966('0xb'),_0x8966('0xc'));var jsn;var lastIndex;var timedata={'06:00':_0x8966('0xd'),'06:30':_0x8966('0xe'),'07:00':_0x8966('0xf'),'07:30':_0x8966('0x10'),'08:00':'8:00\x20am','08:30':_0x8966('0x11'),'09:00':_0x8966('0x12'),'09:30':'9:30\x20am','10:00':_0x8966('0x13'),'10:30':'10:30\x20am','11:00':_0x8966('0x14'),'11:30':_0x8966('0x15'),'12:00':_0x8966('0x16'),'12:30':'12:30\x20pm','13:00':_0x8966('0x17'),'13:30':_0x8966('0x18'),'14:00':_0x8966('0x19'),'14:30':_0x8966('0x1a'),'15:00':_0x8966('0x1b'),'15:30':_0x8966('0x1c'),'16:00':_0x8966('0x1d'),'16:30':_0x8966('0x1e'),'17:00':'5:00\x20pm','17:30':_0x8966('0x1f'),'18:00':'6:00\x20pm','18:30':_0x8966('0x20'),'19:00':'7:00\x20pm','19:30':_0x8966('0x21'),'20:00':_0x8966('0x22'),'20:30':_0x8966('0x23'),'21:00':_0x8966('0x24'),'21:30':_0x8966('0x25'),'22:00':_0x8966('0x26'),'22:30':_0x8966('0x27')};var days={'1':'Monday','2':'Tuesday','3':'Wednesday','4':_0x8966('0x28'),'5':_0x8966('0x29'),'6':_0x8966('0x2a'),'7':_0x8966('0x2b')};var months={'d01':'JAN','d02':_0x8966('0x2c'),'d03':_0x8966('0x2d'),'d04':'APR','d05':_0x8966('0x2e'),'d06':_0x8966('0x2f'),'d07':_0x8966('0x30'),'d08':_0x8966('0x31'),'d09':'SEP','d10':_0x8966('0x32'),'d11':_0x8966('0x33'),'d12':_0x8966('0x34')};var months2={'JAN':'01','FEB':'02','MAR':'03','APR':'04','MAY':'05','JUN':'06','JUL':'07','AUG':'08','SEP':'09','OCT':'10','NOV':'11','DEC':'12'};var app={'initialize':function(){document['addEventListener'](_0x8966('0x35'),function(_0x41bb6f){navigator[_0x8966('0x36')][_0x8966('0x37')](_0x8966('0x38'),function(_0x4cebcb){if(_0x4cebcb==0x2){navigator[_0x8966('0x39')][_0x8966('0x3a')]();};},'',[_0x8966('0x3b'),_0x8966('0x3c')]);},!![]);cordova[_0x8966('0x3d')]['notification'][_0x8966('0x3e')][_0x8966('0x3f')](function(_0x10b01d){global[_0x8966('0x40')]('Notification\x20Cancelled');},this);if(localStorage[_0x8966('0x41')](_0x8966('0x42'))==_0x8966('0x43')){$(_0x8966('0x44'))[_0x8966('0x45')](_0x8966('0x46'),!![]);app[_0x8966('0x47')]();}else{}},'bindEvents':function(){},'onDeviceReady':function(){},'receivedEvent':function(_0x30ed8e){},'onLogin':function(){$(_0x8966('0x48'))[_0x8966('0x49')]();var _0x20b970;var _0x541bb8;$(_0x8966('0x4a'))[_0x8966('0x4b')](localStorage[_0x8966('0x41')](_0x8966('0x9')));if(localStorage[_0x8966('0x41')](_0x8966('0x42'))=='true'){_0x20b970=localStorage['getItem'](_0x8966('0x4c'));_0x541bb8=localStorage[_0x8966('0x41')](_0x8966('0x4d'));}else{_0x20b970=$(_0x8966('0x4e'))[_0x8966('0x4f')]();_0x541bb8=$(_0x8966('0x50'))[_0x8966('0x4f')]();}if(app[_0x8966('0x51')]()){$[_0x8966('0x52')]({'url':localStorage[_0x8966('0x41')](_0x8966('0xb'))+_0x8966('0x53'),'dataType':_0x8966('0x54'),'type':'POST','beforeSend':function(_0x399eec){_0x399eec['setRequestHeader'](_0x8966('0x4c'),_0x20b970);_0x399eec['setRequestHeader'](_0x8966('0x55'),_0x541bb8);_0x399eec['setRequestHeader']('ecode',localStorage[_0x8966('0x41')](_0x8966('0x1')));$('#loadingDiv')[_0x8966('0x56')]();$(_0x8966('0x4e'))['attr'](_0x8966('0x57'),'true');$(_0x8966('0x50'))[_0x8966('0x58')](_0x8966('0x57'),_0x8966('0x43'));$(_0x8966('0x59'))['attr'](_0x8966('0x5a'),_0x8966('0x43'));},'success':function(_0x160cb1){$(_0x8966('0x5b'))[_0x8966('0x49')]();$('#empnumber')[_0x8966('0x5c')](_0x8966('0x57'));$(_0x8966('0x50'))[_0x8966('0x5c')](_0x8966('0x57'));$(_0x8966('0x59'))[_0x8966('0x5c')](_0x8966('0x5a'));if(_0x160cb1[_0x8966('0x5d')]==_0x8966('0x43')){localStorage[_0x8966('0x0')]('empnumber',_0x20b970);localStorage[_0x8966('0x0')](_0x8966('0x5e'),_0x160cb1['college_1']);localStorage[_0x8966('0x0')](_0x8966('0x5f'),_0x160cb1[_0x8966('0x5f')]);localStorage['setItem'](_0x8966('0x60'),_0x160cb1[_0x8966('0x60')]);localStorage['setItem'](_0x8966('0x61'),_0x160cb1['full_empnumber']);localStorage[_0x8966('0x0')](_0x8966('0x62'),_0x160cb1[_0x8966('0x62')]);localStorage[_0x8966('0x0')]('mypass',_0x541bb8);localStorage[_0x8966('0x0')]('passwordValidator',_0x541bb8);if($(_0x8966('0x44'))['is'](_0x8966('0x63'))){localStorage['setItem'](_0x8966('0x42'),_0x8966('0x43'));}else{localStorage[_0x8966('0x0')]('remember',_0x8966('0x4'));};jsn=JSON['parse'](localStorage['getItem']('schedule-'+localStorage['getItem'](_0x8966('0x4c'))));if(localStorage[_0x8966('0x41')](_0x8966('0x64')+localStorage[_0x8966('0x41')]('empnumber'))==_0x8966('0x43')){cordova['plugins'][_0x8966('0x36')][_0x8966('0x3e')][_0x8966('0x3f')](function(_0x15d65e){console['log'](_0x8966('0x65'));},this);app[_0x8966('0x66')]();}if(_0x160cb1[_0x8966('0x67')]==_0x8966('0x43')){window[_0x8966('0x68')]=_0x8966('0x69');}else{window[_0x8966('0x68')]=_0x8966('0x6a');};}else{$(_0x8966('0x5b'))['hide']();$(_0x8966('0x4e'))[_0x8966('0x5c')](_0x8966('0x57'));$(_0x8966('0x50'))[_0x8966('0x5c')](_0x8966('0x57'));$(_0x8966('0x59'))[_0x8966('0x5c')](_0x8966('0x5a'));$(_0x8966('0x48'))[_0x8966('0x4b')](_0x8966('0x6b'));$('.alert')[_0x8966('0x56')]();}},'error':function(_0x490660,_0x3aa9d2,_0x4d98c7){global[_0x8966('0x40')](_0x8966('0x6c')+JSON[_0x8966('0x6d')](_0x490660));$(_0x8966('0x5b'))[_0x8966('0x49')]();$(_0x8966('0x4e'))['removeAttr'](_0x8966('0x57'));$(_0x8966('0x50'))[_0x8966('0x5c')](_0x8966('0x57'));$(_0x8966('0x59'))[_0x8966('0x5c')](_0x8966('0x5a'));alert(JSON[_0x8966('0x6d')](_0x490660));$(_0x8966('0x48'))[_0x8966('0x4b')](_0x8966('0x6e'));$(_0x8966('0x48'))[_0x8966('0x56')]();}});}else{$('.alert')[_0x8966('0x4b')](_0x8966('0x6f'));$(_0x8966('0x48'))[_0x8966('0x56')]();}return![];},'validation':function(){if(localStorage[_0x8966('0x41')](_0x8966('0x42'))==_0x8966('0x43')){return!![];}else{if($(_0x8966('0x4e'))[_0x8966('0x4f')]()[_0x8966('0x70')]==0x0){return![];}if($(_0x8966('0x50'))[_0x8966('0x4f')]()[_0x8966('0x70')]==0x0){return![];}return!![];}},'isNumber':function(_0x51c66e){var _0x549c79=_0x51c66e[_0x8966('0x71')]?_0x51c66e['which']:_0x51c66e[_0x8966('0x72')];if(_0x549c79!=0x2e&&_0x549c79>0x1f&&(_0x549c79<0x30||_0x549c79>0x39))return![];return!![];},'onLogout':function(){window['location'][_0x8966('0x73')](_0x8966('0x74'));},'toggleSwitch':function(){var _0x78ebe6=0x1;var _0x41dda9=[];var _0xf62a7a=0x0;var _0x560935=0x0;var _0x14a74b=_0x8966('0x75');$[_0x8966('0x76')](jsn,function(_0x29803c,_0xed739d){var _0x1a0991=0x0;var _0x16ad37=0x0;if(_0xed739d[_0x8966('0x77')][_0x8966('0x78')](':')[0x1]==0x0){_0x1a0991=parseInt(_0xed739d[_0x8966('0x77')][_0x8966('0x78')](':')[0x0])-0x1;_0x16ad37=0x32;}else{_0x1a0991=parseInt(_0xed739d[_0x8966('0x77')]['split'](':')[0x0]);_0x16ad37=parseInt(_0xed739d[_0x8966('0x77')]['split'](':')[0x1])-0xa;}_0x41dda9[_0x560935++]={'id':_0x560935,'title':_0x14a74b,'text':'AM\x20TIME\x20IN','trigger':{'count':0x5a0,'every':{'weekday':parseInt(_0xed739d[_0x8966('0x79')]),'hour':_0x1a0991,'minute':_0x16ad37,'second':0x0}},'data':{'processor':!![],'sort':0x1}};_0x41dda9[_0x560935++]={'id':_0x560935,'title':_0x14a74b,'text':'AM\x20TIME\x20OUT','trigger':{'count':0x5a0,'every':{'weekday':parseInt(_0xed739d[_0x8966('0x79')]),'hour':parseInt(_0xed739d[_0x8966('0x7a')][_0x8966('0x78')](':')[0x0]),'minute':parseInt(_0xed739d[_0x8966('0x7a')]['split'](':')[0x1]),'second':0x1}},'data':{'processor':!![],'sort':0x2}};var _0x215f14=0x0;var _0x1410c7=0x0;if(_0xed739d['pmS'][_0x8966('0x78')](':')[0x1]==0x0){_0x215f14=parseInt(_0xed739d[_0x8966('0x7b')][_0x8966('0x78')](':')[0x0])-0x1;_0x1410c7=0x32;}else{_0x215f14=parseInt(_0xed739d[_0x8966('0x7b')][_0x8966('0x78')](':')[0x0]);_0x1410c7=parseInt(_0xed739d[_0x8966('0x7b')][_0x8966('0x78')](':')[0x1])-0xa;}_0x41dda9[_0x560935++]={'id':_0x560935,'title':_0x14a74b,'text':_0x8966('0x7c'),'trigger':{'count':0x5a0,'every':{'weekday':parseInt(_0xed739d[_0x8966('0x79')]),'hour':_0x215f14,'minute':_0x1410c7,'second':0x0}},'data':{'processor':!![],'sort':0x3}};_0x41dda9[_0x560935++]={'id':_0x560935,'title':_0x14a74b,'text':_0x8966('0x7d'),'trigger':{'count':0x5a0,'every':{'weekday':parseInt(_0xed739d['day']),'hour':parseInt(_0xed739d[_0x8966('0x7e')][_0x8966('0x78')](':')[0x0]),'minute':parseInt(_0xed739d[_0x8966('0x7e')][_0x8966('0x78')](':')[0x1]),'second':0x0}},'data':{'processor':!![],'sort':0x4}};});cordova[_0x8966('0x3d')][_0x8966('0x36')][_0x8966('0x3e')][_0x8966('0x7f')](_0x41dda9);cordova['plugins'][_0x8966('0x36')]['local']['on'](_0x8966('0x80'),function(_0x2f1f1c){if(_0x2f1f1c[_0x8966('0x81')][_0x8966('0x82')]){$['ajax']({'url':localStorage[_0x8966('0x41')]('server')+_0x8966('0x83'),'type':'POST','dataType':_0x8966('0x54'),'beforeSend':function(_0x454df7){_0x454df7[_0x8966('0x84')]('ecode',localStorage[_0x8966('0x41')]('ecode'));},'success':function(_0x1568ef){var _0x3bc933=_0x1568ef[_0x8966('0x85')][_0x8966('0x78')]('/')[0x2];var _0x365b9d=_0x1568ef[_0x8966('0x85')][_0x8966('0x78')]('/')[0x0];var _0x5a8507=_0x1568ef[_0x8966('0x85')][_0x8966('0x78')]('/')[0x1];var _0x29304f=_0x3bc933+'-'+_0x365b9d+'-'+_0x5a8507;var _0x138e60=_0x5a8507+'-'+months['d'+_0x365b9d]+'-'+_0x3bc933;app['getDTRRecord'](_0x1568ef[_0x8966('0x85')],_0x2f1f1c[_0x8966('0x81')]['sort']);},'error':function(_0x32b625,_0x15f704,_0x2c37ab){global[_0x8966('0x40')]('AJAX\x20ERROR\x20AT\x20serverdt\x20:\x20'+JSON['stringify'](_0x32b625));}});}});localStorage[_0x8966('0x0')](_0x8966('0x64')+localStorage[_0x8966('0x41')](_0x8966('0x4c')),_0x8966('0x43'));},'getDTRRecord':function(_0xefec3e,_0x2d6dea){var _0xbcb0c1=_0xefec3e[_0x8966('0x78')]('/')[0x2];var _0x1576c7=_0xefec3e['split']('/')[0x0];var _0x1c1c31=_0xefec3e['split']('/')[0x1];$(_0x8966('0x86'))[_0x8966('0x4b')](_0x1c1c31+'-'+months['d'+_0x1576c7]+'-'+_0xbcb0c1);$[_0x8966('0x52')]({'url':localStorage[_0x8966('0x41')]('server')+_0x8966('0x87'),'type':_0x8966('0x88'),'dataType':_0x8966('0x54'),'beforeSend':function(_0x4bb1e7){_0x4bb1e7['setRequestHeader'](_0x8966('0x1'),localStorage[_0x8966('0x41')](_0x8966('0x1')));_0x4bb1e7[_0x8966('0x84')](_0x8966('0x4c'),localStorage['getItem'](_0x8966('0x4c')));_0x4bb1e7[_0x8966('0x84')](_0x8966('0x89'),_0xefec3e);},'success':function(_0x5344be){var _0x23b34d=0x0;var _0x3690c1=![];var _0x5473be='';var _0x18cd80=![];var _0x4498f1=![];var _0x348ccc=![];var _0x9aed44=![];$[_0x8966('0x76')](_0x5344be,function(_0x55e154,_0x522c58){if(_0x23b34d==0x0){if(_0x55e154==0x0){_0x18cd80=!![];_0x23b34d++;}}else if(_0x23b34d==0x1){if(_0x5344be[_0x55e154][_0x8966('0x8a')]==_0x8966('0x8b')){_0x4498f1=!![];_0x23b34d++;}}else if(_0x23b34d==0x2){if(_0x5344be[_0x55e154][_0x8966('0x8a')]=='IN'){_0x348ccc=!![];_0x23b34d++;}}else if(_0x23b34d==0x3){if(_0x5344be[_0x55e154][_0x8966('0x8a')]==_0x8966('0x8b')){_0x9aed44=!![];_0x23b34d++;}}});if(_0x2d6dea==0x1&&_0x18cd80==![]){_0x3690c1=!![];_0x5473be='DTR\x20Alert:\x2010\x20Minutes\x20before\x20AM\x20time\x20in';}else if(_0x2d6dea==0x2&&_0x4498f1==![]){_0x3690c1=!![];_0x5473be=_0x8966('0x8c');}else if(_0x2d6dea==0x3&&_0x348ccc==![]){_0x3690c1=!![];_0x5473be=_0x8966('0x8d');}else if(_0x2d6dea==0x4&&_0x9aed44==![]){_0x3690c1=!![];_0x5473be=_0x8966('0x8e');}if(_0x3690c1){cordova[_0x8966('0x3d')][_0x8966('0x36')]['local'][_0x8966('0x7f')]({'id':0x3e7,'title':_0x8966('0x8f'),'text':_0x5473be,'foreground':!![],'data':{'processor':![]}});}},'error':function(_0x2baf6a,_0xd63edf,_0x2ec463){}});}};//localStorage.setItem("ecode" , "aaa");
localStorage.setItem("ecode" 		, "u9n4mT^a|X!545P"	); // Same as Server code --HeaderParam xml ecode 
localStorage.setItem("isEmu" 		, "false"	);
localStorage.setItem("showAlert"	, "console"	);
localStorage.setItem("isBypass"		, "false"	);
localStorage.setItem("isRemember" 	, "false"	);
localStorage.setItem("curinfo"		, "0"		);
localStorage.setItem("version" 		, "3.1.9"  );

//localStorage.setItem("server"		, "http://10.1.16.29:7101/restServiceUSSAP/resources/"		);
//localStorage.setItem("server"		, "http://172.24.0.120:9279/restServiceUSSAP/resources/"	);
//localStorage.setItem("server"		, "http://10.1.16.29:7101/restServiceUSSAP/resources/"		);
localStorage.setItem("server"		, "https://supportstaff.ust.edu.ph/restServiceUSSAP/resources/");

/*-------------------------------------------------*/
/* SCHEDULE DATA */
var jsn;
var lastIndex;

var grid = {};

var checking = {
	
	
}

var timedata = {
	"06:00" : "6:00 am",
	"06:30" : "6:30 am",
	"07:00" : "7:00 am",
	"07:30" : "7:30 am",
	"08:00" : "8:00 am",
	"08:30" : "8:30 am",
	"09:00" : "9:00 am",
	"09:30" : "9:30 am",
	"10:00" : "10:00 am",
	"10:30" : "10:30 am",
	"11:00" : "11:00 am",
	"11:30" : "11:30 am",
	"12:00" : "12:00 pm",
	"12:30" : "12:30 pm",
	"13:00" : "1:00 pm",
	"13:30" : "1:30 pm",
	"14:00" : "2:00 pm",
	"14:30" : "2:30 pm",
	"15:00" : "3:00 pm",
	"15:30" : "3:30 pm",
	"16:00" : "4:00 pm",
	"16:30" : "4:30 pm",
	"17:00" : "5:00 pm",
	"17:30" : "5:30 pm",
	"18:00" : "6:00 pm",
	"18:30" : "6:30 pm",
	"19:00" : "7:00 pm",
	"19:30" : "7:30 pm",
	"20:00" : "8:00 pm",
	"20:30" : "8:30 pm",
	"21:00" : "9:00 pm",
	"21:30" : "9:30 pm",
	"22:00" : "10:00 pm",
	"22:30" : "10:30 pm"
}
var days =  {
	"1" : "Monday",
	"2" : "Tuesday",
	"3" : "Wednesday",
	"4" : "Thursday",
	"5" : "Friday",
	"6" : "Satruday",
	"7" : "Sunday"
}
var months = {
	d01 : "JAN",
	d02 : "FEB",
	d03 : "MAR", 
	d04 : "APR", 
	d05 : "MAY", 
	d06 : "JUN", 
	d07 : "JUL", 
	d08 : "AUG", 
	d09 : "SEP", 
	d10 : "OCT", 
	d11 : "NOV", 
	d12 : "DEC" 
};

var months2 = {
	JAN : "01",
	FEB : "02",
	MAR : "03",
	APR : "04",
	MAY : "05",
	JUN : "06",
	JUL : "07",
	AUG : "08",
	SEP : "09",
	OCT : "10",
	NOV : "11",
	DEC : "12"
};
/**/
var app = {
	
    initialize: function() {
        
        
        document.addEventListener("backbutton", function(e){
			navigator.notification.confirm(
				"Exit application?",        	 	// Alert Message
				function(buttonIndex) {				// Callback on message
					if (buttonIndex == 2) {			
						navigator.app.exitApp();
					};
				},                 					// callback
				"",           						// title
				['Cancel', 'Exit']                  // Buttons
			);	
		}, true);
        cordova.plugins.notification.local.cancelAll(function(notification) {
			global.sys("Notification Cancelled");
		}, this);
		
		//alert(localStorage.getItem("remember"));
		
		if (localStorage.getItem("remember") == "true"){
			$("#rememberme").prop("checked", true);
			app.onLogin();
		} else {
			
		}
    },
    
    bindEvents: function() {
           
		

    }, 

    onDeviceReady: function() {

		 
		/* CANCEL ALL PENDING NOTIF WHEN INDEX LOADS */
		
    }, 
    
    receivedEvent: function(id) {
		
    },
    
    onLogin: function(){
		$(".alert").hide();
		var empnum;
		var pass;
		$("#currentVersion").html(localStorage.getItem("version"));
        
		if (localStorage.getItem("remember") == "true") {
			empnum = localStorage.getItem("empnumber");
			pass   = localStorage.getItem("mypass");
		} else {
                       // empnum = "4816";
			empnum = $("#empnumber").val();
			pass = $("#password").val();
			
		}
		
		if (app.validation()) {
			//return false;
			//alert(localStorage.getItem("server") + "service/login");
            $.ajax(
             {
                url        : localStorage.getItem("server") + "service/login",
                dataType   : "json",
                type       : "POST",
                beforeSend : function(xhr){
                    xhr.setRequestHeader('empnumber' ,  empnum			);
                    xhr.setRequestHeader('password'  ,  pass			);
                    xhr.setRequestHeader('ecode'     ,  localStorage.getItem("ecode") 	);
					
					$("#loadingDiv"		).show();
					$("#empnumber"		).attr("readonly"	, "true" );
					$("#password"		).attr("readonly"	, "true" );
					$("#loginButton"	).attr("disabled"	, "true" );
                },
                success    : function(msg) { 
					$("#loadingDiv").hide();
					$("#empnumber").removeAttr("readonly");
					$("#password").removeAttr("readonly");
					$("#loginButton").removeAttr("disabled");
				   //alert("VALDIATED: " + msg["validated"]);
                   if (msg["validated"] == "true") {
					  
					  
					   
                            localStorage.setItem("empnumber"       , empnum  );
                            //localStorage.setItem("empnumber"       , "4816"  );
					  localStorage.setItem("college_1"       , msg["college_1"]       );
					  localStorage.setItem("college_2"       , msg["college_2"]       );
					  localStorage.setItem("full_name"       , msg["full_name"]       );
					  localStorage.setItem("full_empnumber"  , msg["full_empnumber"]  );
					  localStorage.setItem("employment_date" , msg["employment_date"] );
					  localStorage.setItem("mypass" , pass);
					  
					  
					  //alert(localStorage.getItem("full_empnumber"));
				
					  localStorage.setItem("passwordValidator",pass);
					  
					  
					  	if ($("#rememberme").is(":checked")) {
							localStorage.setItem("remember", "true");
						} else {
							localStorage.setItem("remember", "false");
						};
						
                                                //alert(localStorage.getItem("remember"));
						jsn = JSON.parse(localStorage.getItem("schedule-" + localStorage.getItem("empnumber")));
							
						if (localStorage.getItem("notification-" + localStorage.getItem("empnumber")) == "true") {	
							cordova.plugins.notification.local.cancelAll(function(notification) {
								console.log("notifications cancelled : BEFORE RE SCHEDULED");
							}, this);
							app.toggleSwitch();
						} 
					  if (msg["initial"] == "true") {
						// GO TO INITIAL SETUP

						window.location = "initialsetup.html";
					  } else {
						// GO DIRECTLY TO PROFILE
						window.location = "profile.html";
					  };
					  
		
                   } else {
					    $("#loadingDiv"  ).hide();
						$("#empnumber"   ).removeAttr("readonly");
						$("#password"    ).removeAttr("readonly");
						$("#loginButton" ).removeAttr("disabled");
					
					    $(".alert").html("Invalid Login");
					    $(".alert").show();

				   }
                },
                error     : function(jqXHR	, textStatus, errorThrown) {
					global.sys("ERROR AT AJAX LOGIN : " + JSON.stringify(jqXHR));
					$("#loadingDiv" ).hide();
					$("#empnumber"  ).removeAttr("readonly");
					$("#password"   ).removeAttr("readonly");
					$("#loginButton").removeAttr("disabled");
					//alert(JSON.stringify(jqXHR));
					
					$(".alert").html("There was an error connecting to the server.");
					$(".alert").show();
			   }
            });
        } else {
            $(".alert").html("Employee number and password is required.");
			$(".alert").show();		
		}
		return false;
    },
    
    validation: function() {
		
		if (localStorage.getItem("remember")=="true"){
			return true;
		} else {
			if ( $("#empnumber").val().length == 0 ) {
				return false;
			}
			
			if ($("#password").val().length == 0 ) {
				return false;
			}
			return true;
		}
		
      
    },
	
	isNumber: function(evt) {
        var iKeyCode = (evt.which) ? evt.which : evt.keyCode
        if (iKeyCode != 46 && iKeyCode > 31 && (iKeyCode < 48 || iKeyCode > 57)) return false;
        return true;
    }  ,
	onLogout: function(){
		window.location.replace("index.html");
	}  ,	
	toggleSwitch: function(){
		var check = 1;
		var data = [];
		var dtrFlag = 0;
	
			var index = 0;

			var defaultTitle = "Daily Time Record Alert";
			$.each(jsn, function(i,e){
					
					
				var r_amS_H = 0;
				var r_amS_M = 0;
				if (e["amS"].split(":")[1] == 0){
					r_amS_H = parseInt(e["amS"].split(":")[0]) - 1;
					r_amS_M = 50;
				} else {
					r_amS_H = parseInt(e["amS"].split(":")[0]);
					r_amS_M = parseInt(e["amS"].split(":")[1]) - 10;
				}
			
				data[index++] = {
					id   	: index,
					title	: defaultTitle, 
					text : "AM TIME IN",
					trigger : { 
								count: 1440,
								every: { 
									weekday	: parseInt(e["day"]), 
									hour	: r_amS_H,
									minute	: r_amS_M,
									second  : 0
								}
							 },
					
					data: { processor: true,sort: 1 }
				};

		
				data[index++] = {
					id   	: index,
					title	: defaultTitle, 
					text : "AM TIME OUT",
					trigger : { 
								count: 1440,
								every: { 
									weekday	: parseInt(e["day"]), 
									hour	: parseInt(e["amE"].split(":")[0]), 
									minute	: parseInt(e["amE"].split(":")[1]),
									second  : 1
								}
							  },
					
					data: { processor: true,sort: 2 }
				};
				
					
				
				var r_pmS_H = 0;
				var r_pmS_M = 0;
				if (e["pmS"].split(":")[1] == 0){
					r_pmS_H = parseInt(e["pmS"].split(":")[0]) - 1;
					r_pmS_M = 50;
				} else {
					r_pmS_H = parseInt(e["pmS"].split(":")[0]);
					r_pmS_M = parseInt(e["pmS"].split(":")[1]) - 10;
				}
				
				data[index++] = {
					id   	: index,
					title	: defaultTitle, 
					text : "PM TIME IN",
					trigger : { 
								count: 1440,
								every: { 
									weekday	: parseInt(e["day"]), 
									hour	: r_pmS_H, 
									minute	: r_pmS_M,
									second  : 0
								}
							 },
					
					data: { processor: true,sort: 3 }
				};
				
				data[index++] = {
					id   	: index,
					title	: defaultTitle, 
					text : "PM TIME OUT",
					trigger	: { 
								count: 1440,
								every: { 
									weekday	: parseInt(e["day"]), 
									hour	: parseInt(e["pmE"].split(":")[0]), 
									minute	: parseInt(e["pmE"].split(":")[1]),
									second  : 0
								}
							 },
					
					data: { processor: true, sort: 4 }
				};
				
			});
				
			//alert(JSON.stringify(data));
			cordova.plugins.notification.local.schedule(data);
			
			// TODO BACKGROUND PROCESS
			// check if notification is working if not do algo
			/*  NOTIFICATION CONDITION CHECKER
				*WORKS BUT APP NEED TO BE MINIMIZED NOT CLOSED
			*/	
			

	
			cordova.plugins.notification.local.on("trigger", function(notification) {
				
				if (notification.data.processor) {
				$.ajax({
					url       : localStorage.getItem("server") + "service/serverdt",
					type      : "POST",
					dataType  : "json",
					beforeSend: function(xhr){
						 xhr.setRequestHeader('ecode'  ,  localStorage.getItem("ecode") ); 
					},  
					success: function(msg) { 
					   //global.msg(msg["date"]);
					   
					   var year 	= msg["date"].split("/")[2];
					   var month 	= msg["date"].split("/")[0];
					   var day 		= msg["date"].split("/")[1];
					   
					   var formatted = year + "-" + month + "-" + day;
					   
					   var formatted_v2 = day + "-" + months["d" + month] + "-" + year;
					   
					   // USE THE FORMATTED DATE
	
					   app.getDTRRecord(msg["date"], notification.data.sort);
					},
					error: function(jqXHR	, textStatus, errorThrown) {  
						global.sys("AJAX ERROR AT serverdt : " + JSON.stringify(jqXHR));
					   //alert(JSON.stringify(jqXHR));
					   //alert(JSON.stringify(textStatus));
					   //alert(JSON.stringify(errorThrown));
					}
				});
				}
			});
			/**/
			
			
			localStorage.setItem("notification-"+ localStorage.getItem("empnumber"), "true" );
			
		
	},
	getDTRRecord: function(pdate,notifId){
		//console.log("i am looping");
		
		//alert("TRYING TO FETCH DTR");
		var year 	= pdate.split("/")[2];
		var month 	= pdate.split("/")[0];
		var day 	= pdate.split("/")[1];
		$("#curdate-holder").html(day + "-" + months["d" + month] + "-" + year);
        $.ajax({
            url      : localStorage.getItem("server") + "attendance/dtr",
            type     : "POST",
            dataType : "json",
            beforeSend: function(xhr){
                 xhr.setRequestHeader('ecode'     ,  localStorage.getItem("ecode"     ) );
                 xhr.setRequestHeader('empnumber' ,  localStorage.getItem("empnumber" ) );
                 xhr.setRequestHeader('pdate'     ,  pdate ); 
            },  
            success: function(msg) { 
			var index = 0;			// check what in or out is current
			var sendNotif = false ;	// if true send notif
			var notifMessage = "";
			var amIn 	= false;
			var amOut 	= false;
			var pmIn 	= false;
			var pmOut	= false;
			
			
			
			
			
			/* 
			
			
			*/
			$.each(msg, function(i,e){
				if ( index == 0 ) {
					if (i==0) {
						amIn = true;
						index++;
					}
				} else if (index == 1){
					if (msg[i]["type"] == "OUT") {
						amOut = true;
						index++;
					} 
				} else if (index == 2){
					if (msg[i]["type"] == "IN"){
						pmIn = true;
						index++;
					}
				} else if (index == 3) {
					if (msg[i]["type"] == "OUT"){
						pmOut = true;
						index++;
					}
				}
			});
			
			
		
			
			/* FLAG CHECKER  */
			//  console.log("############ NOTIF ID :" + notifId);					
			//  console.log("############ FLAGS    :" + amIn + " : " + amOut + " : " + pmIn + " : " + pmOut);
			/* */
			/*
				notif id = 1 == AM IN
				notif id = 2 == AM OUT 
				notif id = 3 == PM IN 
				notif id = 4 == PM OUT
			*/
			
			
			if (notifId == 1 && amIn  == false) {
				sendNotif = true;
				notifMessage = "DTR Alert: 10 Minutes before AM time in";
            } else if (notifId == 2 && amOut == false) {
				sendNotif = true;
				notifMessage = "DTR Alert: Time out for am schedule";
			} else if (notifId == 3 && pmIn  == false) {
				sendNotif = true;
				notifMessage = "DTR Alert: 10 Minutes before PM time in";
			} else if (notifId == 4 && pmOut == false) {
				sendNotif = true;
				notifMessage = "DTR Alert: Time out for pm schedule";
			}
			
			if (sendNotif) {
				cordova.plugins.notification.local.schedule( {
					id		: 999,
					title	: "DTR Reminder", 
					text 	: notifMessage,
					foreground: true,
					data: {processor: false}
				});
			}
			
			
			
			},
            error: function(jqXHR	, textStatus, errorThrown) {  
				//global.msg("jqXHR: " 		  + JSON.stringify(jqXHR)		);
             	//global.msg("STATUS: " 	  + JSON.stringify(textStatus)	);
				//global.msg("ERROR THROWN: " + JSON.stringify(errorThrown)	);
            }
        });  
    }
};
